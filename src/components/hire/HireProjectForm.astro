---
import PixelarticonsArrowRight from "../icons/PixelarticonsArrowRight.astro";
import PixelarticonsBriefcase from "../icons/PixelarticonsBriefcase.astro";
import PixelarticonsMailCheck from "../icons/PixelarticonsMailCheck.astro";
import PixelarticonsMailDelete from "../icons/PixelarticonsMailDelete.astro";
import HireProjectContactInfo from "./HireProjectContactInfo.astro";
import HireProjectDetails from "./HireProjectDetails.astro";
import HireProjectPreferences from "./HireProjectPreferences.astro";

const locale = (Astro.currentLocale as "en" | "sv") ?? "en";

const translations = {
  en: {
    heading: "Start your project",
    description:
      "Ready to bring your vision to life? Fill out the form below with details about your project, and I'll get back to you within 24 to 48 hours with a personalized proposal.",
    securityAria: "Security verification",
    submitButton: "Send project inquiry",
    successMessage: "Project inquiry sent! I'll get back within 24 hours.",
    errorMessage: "Sending failed! Please try again.",
  },
  sv: {
    heading: "Starta ditt projekt",
    description:
      "Redo att förverkliga din vision? Fyll i formuläret med information om ditt projekt, så återkommer jag inom 24 till 48 timmar med ett personligt förslag.",
    securityAria: "Säkerhetsverifiering",
    submitButton: "Skicka projektförfrågan",
    successMessage:
      "Projektförfrågan skickades! Jag återkommer inom 24 timmar.",
    errorMessage: "Skickandet misslyckades! Försök igen.",
  },
};
---

<section id="project-form-section" class="space-y-8">
  <header class="space-y-2">
    <h2 class="font-serif text-2xl text-stone-800 dark:text-stone-100">
      <PixelarticonsBriefcase
        aria-hidden="true"
        class="mr-1 mb-1 inline-block"
      />
      {translations[locale].heading}
    </h2>
    <p class="leading-relaxed text-stone-600 dark:text-stone-400">
      {translations[locale].description}
    </p>
  </header>

  <form
    id="project-inquiry-form"
    method="post"
    class="flex flex-col gap-4 overflow-hidden border-stone-300 sm:border sm:p-6 dark:border-stone-700"
  >
    <HireProjectContactInfo />
    <HireProjectDetails />
    <HireProjectPreferences />

    <div
      id="turnstile-container"
      aria-label={translations[locale].securityAria}
      class="hidden"
    >
    </div>

    <button
      type="submit"
      id="project-submit-btn"
      class="group flex w-full cursor-pointer items-center justify-center gap-1 bg-[#FF3030] p-2 text-sm font-medium tracking-tight text-stone-50 transition hover:opacity-75 active:scale-[0.97] active:opacity-50 disabled:cursor-not-allowed disabled:opacity-50"
    >
      <PixelarticonsBriefcase aria-hidden="true" class="h-4 w-4" />
      <span>{translations[locale].submitButton}</span>
      <PixelarticonsArrowRight
        aria-hidden="true"
        class="h-4 w-4 transition-transform group-hover:translate-x-0.5"
      />
    </button>

    <div
      id="project-success-message"
      role="status"
      aria-live="polite"
      class="hidden w-full flex-wrap items-center justify-center gap-1 bg-green-600 p-2 text-sm text-stone-50"
    >
      <PixelarticonsMailCheck aria-hidden="true" class="h-4 w-4" />
      <span>
        {translations[locale].successMessage}
      </span>
    </div>

    <div
      id="project-error-message"
      role="alert"
      aria-live="assertive"
      class="hidden w-full flex-wrap items-center justify-center gap-1 bg-red-600 p-2 text-sm text-stone-50"
    >
      <PixelarticonsMailDelete aria-hidden="true" class="h-4 w-4" />
      <span id="project-error-text">{translations[locale].errorMessage}</span>
    </div>
  </form>
</section>

<script>
  import "./HireProjectForm";
</script>
