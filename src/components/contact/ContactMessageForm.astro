---
import PixelarticonsArrowRight from "../icons/PixelarticonsArrowRight.astro";
import PixelarticonsMail from "../icons/PixelarticonsMail.astro";
import PixelarticonsMailCheck from "../icons/PixelarticonsMailCheck.astro";
import PixelarticonsMailDelete from "../icons/PixelarticonsMailDelete.astro";

const translations = {
  en: {
    heading: "Leave a message",
    description:
      "In case you prefer traditional contact forms, then feel free to leave me a message. I'll get back to you as soon as I can via email.",
    labelName: "Name *",
    placeholderName: "Enter your name",
    labelEmail: "Email *",
    placeholderEmail: "Enter your email",
    labelMessage: "Message *",
    placeholderMessage: "Type your message here...",
    securityAriaLabel: "Security verification",
    buttonSend: "Send message",
    successMessage: "Message sent. Talk to you soon!",
    errorMessage: "Sending failed. Try again later!",
  },
  sv: {
    heading: "Lämna ett meddelande",
    description:
      "Om du föredrar traditionella kontaktformulär, tveka inte att lämna ett meddelande. Jag återkommer så snart jag kan via e-post.",
    labelName: "Namn *",
    placeholderName: "Ange ditt namn",
    labelEmail: "E-post *",
    placeholderEmail: "Ange din e-post",
    labelMessage: "Meddelande *",
    placeholderMessage: "Skriv ditt meddelande här...",
    securityAriaLabel: "Säkerhetsverifiering",
    buttonSend: "Skicka meddelande",
    successMessage: "Meddelandet har skickats. Vi hörs!",
    errorMessage: "Skickning misslyckades. Försök igen!",
  },
};

const locale = (Astro.currentLocale as "en" | "sv") ?? "en";
---

<section id="contact-form-section">
  <div class="mt-8 space-y-8">
    <header class="max-w-lg space-y-2">
      <h2 class="font-serif text-2xl text-stone-800 dark:text-stone-100">
        <PixelarticonsMail aria-hidden="true" class="mr-1 mb-1 inline-block" />
        {translations[locale].heading}
      </h2>
      <p class="leading-relaxed text-stone-500">
        {translations[locale].description}
      </p>
    </header>

    <form
      id="contact-form"
      method="post"
      class="flex flex-col gap-4 overflow-hidden border-stone-300 sm:border sm:p-6 dark:border-stone-700"
    >
      <fieldset class="flex flex-col gap-4 lg:flex-row">
        <legend
          class="mb-4 text-sm font-medium tracking-wider text-stone-500 uppercase"
        >
          {translations[locale].heading}
        </legend>

        <div class="w-full">
          <label
            for="name"
            class="text-sm font-medium tracking-tight text-stone-800 dark:text-stone-100"
          >
            {translations[locale].labelName}
          </label>
          <input
            type="text"
            id="name"
            name="name"
            autocomplete="name"
            required
            placeholder={translations[locale].placeholderName}
            class="mt-2 w-full border border-stone-300 px-3 py-2 placeholder:text-stone-500 dark:border-stone-700 dark:bg-stone-800 dark:text-stone-100"
          />
        </div>

        <div class="w-full">
          <label
            for="email"
            class="text-sm font-medium tracking-tight text-stone-800 dark:text-stone-100"
          >
            {translations[locale].labelEmail}
          </label>
          <input
            type="email"
            id="email"
            name="email"
            autocomplete="email"
            required
            placeholder={translations[locale].placeholderEmail}
            class="mt-2 w-full border border-stone-300 px-3 py-2 placeholder:text-stone-500 dark:border-stone-700 dark:bg-stone-800 dark:text-stone-100"
          />
        </div>
      </fieldset>

      <div>
        <label
          for="message"
          class="text-sm font-medium tracking-tight text-stone-800 dark:text-stone-100"
        >
          {translations[locale].labelMessage}
        </label>
        <textarea
          id="message"
          name="message"
          required
          rows="4"
          placeholder={translations[locale].placeholderMessage}
          class="mt-2 w-full border border-stone-300 px-3 py-2 placeholder:text-stone-500 dark:border-stone-700 dark:bg-stone-800 dark:text-stone-100"
        ></textarea>
      </div>

      <div
        id="turnstile-container"
        aria-label={translations[locale].securityAriaLabel}
        class="hidden"
      >
      </div>

      <button
        type="submit"
        id="submit-btn"
        class="group flex w-full cursor-pointer items-center justify-center gap-1 bg-[#FF3030] p-2 text-sm font-medium tracking-tight text-stone-50 transition hover:opacity-75 active:scale-[0.97] active:opacity-50 disabled:cursor-not-allowed disabled:opacity-50"
      >
        <span>{translations[locale].buttonSend}</span>
        <PixelarticonsArrowRight
          aria-hidden="true"
          class="h-4 w-4 transition-transform group-hover:translate-x-0.5"
        />
      </button>

      <div
        id="success-message"
        role="status"
        aria-live="polite"
        class="hidden w-full flex-wrap items-center justify-center gap-1 bg-green-600 p-2 text-sm text-stone-50"
      >
        <PixelarticonsMailCheck aria-hidden="true" class="h-4 w-4" />
        <span>{translations[locale].successMessage}</span>
      </div>

      <div
        id="error-message"
        role="alert"
        aria-live="assertive"
        class="hidden w-full flex-wrap items-center justify-center gap-1 bg-red-600 p-2 text-sm text-stone-50"
      >
        <PixelarticonsMailDelete aria-hidden="true" class="h-4 w-4" />
        <span id="error-text">{translations[locale].errorMessage}</span>
      </div>
    </form>
  </div>
</section>

<script>
  import "./ContactMessageForm";
</script>
