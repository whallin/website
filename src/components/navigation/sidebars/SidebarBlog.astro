---
import PixelarticonsAlignLeft from "../../icons/PixelarticonsAlignLeft.astro";
import PixelarticonsClock from "../../icons/PixelarticonsClock.astro";
import PixelarticonsScriptText from "../../icons/PixelarticonsScriptText.astro";
import SidebarBase from "../SidebarBase.astro";
import { calculateBlogStats } from "./SidebarBlog";

const locale = (Astro.currentLocale as "en" | "sv") ?? "en";
const blogStats = await calculateBlogStats(locale);

const translations = {
  en: {
    totalPosts: "Posts published",
    totalWords: "Total words",
    totalReadTime: "Total read time",
  },
  sv: {
    totalPosts: "Inlägg publicerade",
    totalWords: "Totalt antal ord",
    totalReadTime: "Total lästid",
  },
};

const stats = [
  {
    label: translations[locale].totalPosts,
    value: blogStats.totalPosts.toString(),
    Icon: PixelarticonsScriptText,
  },
  {
    label: translations[locale].totalWords,
    value: `${Math.ceil(blogStats.totalWords / 1000)}k`,
    Icon: PixelarticonsAlignLeft,
  },
  {
    label: translations[locale].totalReadTime,
    value: blogStats.totalReadTime,
    Icon: PixelarticonsClock,
  },
];
---

<SidebarBase showLogo showReturn>
  <div slot="content">
    <aside class="space-y-4 text-xs text-stone-500">
      {
        stats.map((stat) => (
          <div class="space-y-0.5">
            <span class="mb-1 flex items-center gap-1">
              <stat.Icon aria-hidden="true" class="h-4 w-4" />
              {stat.label}
            </span>
            <span class="font-mono text-stone-800 dark:text-stone-300">
              {stat.value}
            </span>
          </div>
        ))
      }
    </aside>
  </div>
</SidebarBase>
