---
import { getCollection } from "astro:content";
import { getRelativeLocaleUrl } from "astro:i18n";
import PixelarticonsArrowRight from "../icons/PixelarticonsArrowRight.astro";

const translations = {
  en: {
    ariaLabel: "Legal documents",
    readDocumentCTA: "Read document",
    noDocuments: "No legal documxents available.",
  },
  sv: {
    ariaLabel: "Juridiska dokument",
    readDocumentCTA: "LÃ¤s dokument",
  },
};

const locale = (Astro.currentLocale as "en" | "sv") ?? "en";

const allLegalDocuments = await getCollection("legalCollection", ({ id }) => {
  return id.startsWith(`${locale}/`);
});
---

<section aria-label={translations[locale].ariaLabel}>
  <ul role="list" class="flex flex-col gap-4 divide-y divide-stone-300">
    {
      allLegalDocuments.map((document) => (
        <li class="pb-4">
          <article>
            <a
              href={getRelativeLocaleUrl(
                locale,
                `/legal/${document.id.replace(`${locale}/`, "")}`,
              )}
              rel="bookmark"
              class="group flex flex-col justify-between gap-2 transition-opacity active:opacity-50 sm:flex-row sm:items-center sm:gap-4"
            >
              <h3 class="font-serif text-xl text-stone-800 decoration-from-font underline-offset-2 group-hover:underline dark:text-stone-100">
                {document.data.title}
              </h3>

              <span
                aria-hidden="true"
                class="px-px text-sm tracking-tight text-stone-500 decoration-from-font underline-offset-2 transition-transform group-hover:translate-x-0.5 group-hover:bg-red-400 group-hover:text-stone-100"
              >
                {translations[locale].readDocumentCTA}
                <PixelarticonsArrowRight
                  aria-hidden="true"
                  class="mb-1 inline-block h-4 w-4 transition-transform group-hover:translate-x-0.5"
                />
              </span>
            </a>
          </article>
        </li>
      ))
    }
  </ul>
</section>
